<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="memberAutoDao">
	<insert id="insertAuto" parameterType="memberAutoVo">
		insert into MEMBER_AUTO (NUM, NICKNAME, REGDATE, LOGINTIME) values
		(MEMBER_AUTO.nextval, #{nickname}, sysdate, sysdate)
	</insert>
	<update id="deleteInfo" parameterType="String">
		update MEMBER_AUTO set WARNCOUNT=0, POINT=0, MODDATE=sysdate, SESSIONID=null, LOGINTIME=NULL
			from NICKNAME=#{nickname}
	</update>
	<update id="updateAuto" parameterType="String">
		update MEMBER_AUTO set 
		<if test="sessionId==null">
			MODDATE=sysdate
		</if> 
		<if test="sessionId!=null">
			SESSIONID=#{sessionId}
		</if>
		where NICKNAME=#{nickname}
	</update>
	<update id="updateWarning" parameterType="String">
		update MEMBER_AUTO set WARNCOUNT=WARNCOUNT+1 where NICKNAME=#{nickname}
	</update>
	<update id="updatePoint" parameterType="HashMap">
		update MEMBER_AUTO set POINT=POINT+#{point} where NICKNAME-#{nickname}
	</update>
	<select id="selectOneAuto" parameterType="String" resultType="memberAutoVo">
		select * from MEMBER_AUTO where NICKNAME=#{nickname}
	</select>
	<select id="selectAllAuto" parameterType="String" resultType="memberAutoVo">
	select * from MEMBER_AUTO where
		<if test="_parameter.equals('black')">
			LOGINTIME=null
		</if>
		<if test="_parameter.equals('normal')">
			LOGINTIME!=null
		</if>
	</select>
	<select id="selectSessionId" parameterType="String" resultType="String">
		select SESSIONID from MEMBER_AUTO where NICKNAME=#{nickname};
	</select>
</mapper>