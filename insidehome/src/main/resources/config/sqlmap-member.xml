<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="memberDao">
	<insert id="insert" parameterType="memberVo">
		insert into MEMBER 
		values (MEMBER_SEQ.nextval, #{email}, #{nickname}, #{password}, #{name}, #{gender}, #{storedate})
	</insert>
	<update id="deleteInfo" parameterType="String">
		update MEMBER set PASSWORD='-', NAME='-', GENDER=null, storedate=null where NICKNAME=#{nickname}
	</update>
	<update id="updateInfo" parameterType="memberVo">
		update MEMBER set GENDER=#{gender}, STOREDATE=#{storedate} where NICKNAME=#{nickname}
	</update>
	<update id="updatePw" parameterType="String">
		update MEMBER set PASSWORD=#{newPassword} where NICKNAME=#{nickname} and PASSWORD=#{password}
	</update>
	<select id="selectOne" parameterType="String" resultType="memberVo">
		select * from MEMBER where NICKNAME=#{nickname}
	</select>
	<select id="selectAll" parameterType="String" resultType="memberVo">
		select * from MEMBER where
		<if test="_parameter.equals('black')">
			password='-'
		</if>
		<if test="_parameter.equals('normal')">
			password!='-'
		</if>
	</select>
	<select id="selectCheck" parameterType="String" resultType="String">
		select ${type} from MEMBER where ${type}=#{str}
	</select>
	<select id="selectExistIfo" parameterType="String" resultType="int">
		select count(*) from MEMBER where EMAIL=#{email} and PASSWORD=#{password} 
	</select>
	<select id="findEmail" parameterType="String" resultType="String">
		select M.EMAIL from MEMBER M, MEMBER_ADDR ADDR
		 where 
		 <if test="type.equals('eamil')">
		 M.EMAIL like '%'||#{email} 
		 </if>
		 <if test="type.equals('password')">
		 M.EMAIL = #{email} 
		 </if>
		 and ADDR.PHONE1=#{phone1} and ADDR.PHONE2=#{phone2} 
	</select>
</mapper>